{"ast":null,"code":"import { map } from '@reactivex/rxjs/src/operators';\nimport { BehaviorSubject } from '@reactivex/rxjs/src/internal/BehaviorSubject';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class AutenticacaoService {\n  constructor(http) {\n    this.http = http;\n    this.baseUrl = 'http://localhost:8080';\n    this.userSubject = new BehaviorSubject({\n      usuario: '',\n      roles: []\n    });\n    const user = sessionStorage.getItem('usuario');\n    if (user) {\n      this.userSubject.next(JSON.parse(user));\n    }\n  }\n  login(userLogin) {\n    return this.http.post(`${this.baseUrl}/login`, userLogin).pipe(map(data => {\n      this.setUserSubject(data);\n      return data;\n    }));\n  }\n  setUserSubject(user) {\n    sessionStorage.setItem('usuario', JSON.stringify(user));\n    this.userSubject.next(user);\n  }\n  getUser() {\n    return this.userSubject.asObservable();\n  }\n  getRoles() {\n    return this.userSubject.getValue().roles;\n  }\n  logout() {\n    this.userSubject.next({\n      usuario: '',\n      roles: []\n    });\n    sessionStorage.clear();\n  }\n}\nAutenticacaoService.ɵfac = function AutenticacaoService_Factory(t) {\n  return new (t || AutenticacaoService)(i0.ɵɵinject(i1.HttpClient));\n};\nAutenticacaoService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: AutenticacaoService,\n  factory: AutenticacaoService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"names":["map","BehaviorSubject","AutenticacaoService","constructor","http","baseUrl","userSubject","usuario","roles","user","sessionStorage","getItem","next","JSON","parse","login","userLogin","post","pipe","data","setUserSubject","setItem","stringify","getUser","asObservable","getRoles","getValue","logout","clear","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["/home/claudioneves/portal-acesso/src/app/auth/autenticacao.service.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { map } from '@reactivex/rxjs/src/operators';\nimport { Observable } from  '@reactivex/rxjs/src/internal/Observable';\nimport { BehaviorSubject } from  '@reactivex/rxjs/src/internal/BehaviorSubject';\nimport { User, UserLogin } from './models/user.models';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AutenticacaoService {\n\n  baseUrl = 'http://localhost:8080';\n\n  private userSubject = new BehaviorSubject<User>({usuario:'', roles:[]});\n\n\n  constructor(private http: HttpClient) { \n    const user = sessionStorage.getItem('usuario');\n    if(user){\n\n      this.userSubject.next(JSON.parse(user));\n    }\n  }\n\n  login(userLogin: UserLogin): Observable<any> {\n    return this.http.post(`${this.baseUrl}/login`, userLogin).pipe(\n      map(data => {\n        \n        this.setUserSubject(data)\n\n        return data;\n      })\n    );\n  }\n\n  private setUserSubject(user: any){\n    sessionStorage.setItem('usuario', JSON.stringify(user));\n    this.userSubject.next(user);\n  }\n\n  getUser(){\n    return this.userSubject.asObservable();\n  }\n\n  getRoles(){\n    return this.userSubject.getValue().roles;\n  }\n\n  logout(){\n    this.userSubject.next({\n      usuario: '',\n      roles: []\n    });\n    sessionStorage.clear();\n  }\n\n\n}"],"mappings":"AAEA,SAASA,GAAG,QAAQ,+BAA+B;AAEnD,SAASC,eAAe,QAAS,8CAA8C;;;AAM/E,OAAM,MAAOC,mBAAmB;EAO9BC,YAAoBC,IAAgB;IAAhB,KAAAA,IAAI,GAAJA,IAAI;IALxB,KAAAC,OAAO,GAAG,uBAAuB;IAEzB,KAAAC,WAAW,GAAG,IAAIL,eAAe,CAAO;MAACM,OAAO,EAAC,EAAE;MAAEC,KAAK,EAAC;IAAE,CAAC,CAAC;IAIrE,MAAMC,IAAI,GAAGC,cAAc,CAACC,OAAO,CAAC,SAAS,CAAC;IAC9C,IAAGF,IAAI,EAAC;MAEN,IAAI,CAACH,WAAW,CAACM,IAAI,CAACC,IAAI,CAACC,KAAK,CAACL,IAAI,CAAC,CAAC;;EAE3C;EAEAM,KAAKA,CAACC,SAAoB;IACxB,OAAO,IAAI,CAACZ,IAAI,CAACa,IAAI,CAAC,GAAG,IAAI,CAACZ,OAAO,QAAQ,EAAEW,SAAS,CAAC,CAACE,IAAI,CAC5DlB,GAAG,CAACmB,IAAI,IAAG;MAET,IAAI,CAACC,cAAc,CAACD,IAAI,CAAC;MAEzB,OAAOA,IAAI;IACb,CAAC,CAAC,CACH;EACH;EAEQC,cAAcA,CAACX,IAAS;IAC9BC,cAAc,CAACW,OAAO,CAAC,SAAS,EAAER,IAAI,CAACS,SAAS,CAACb,IAAI,CAAC,CAAC;IACvD,IAAI,CAACH,WAAW,CAACM,IAAI,CAACH,IAAI,CAAC;EAC7B;EAEAc,OAAOA,CAAA;IACL,OAAO,IAAI,CAACjB,WAAW,CAACkB,YAAY,EAAE;EACxC;EAEAC,QAAQA,CAAA;IACN,OAAO,IAAI,CAACnB,WAAW,CAACoB,QAAQ,EAAE,CAAClB,KAAK;EAC1C;EAEAmB,MAAMA,CAAA;IACJ,IAAI,CAACrB,WAAW,CAACM,IAAI,CAAC;MACpBL,OAAO,EAAE,EAAE;MACXC,KAAK,EAAE;KACR,CAAC;IACFE,cAAc,CAACkB,KAAK,EAAE;EACxB;;AA7CW1B,mBAAmB,C;mBAAnBA,mBAAmB,EAAA2B,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA;AAAA;AAAnB9B,mBAAmB,C;SAAnBA,mBAAmB;EAAA+B,OAAA,EAAnB/B,mBAAmB,CAAAgC,IAAA;EAAAC,UAAA,EAFlB;AAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}